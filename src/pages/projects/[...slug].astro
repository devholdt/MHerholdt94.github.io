---
import { type CollectionEntry, getCollection } from "astro:content";

import BaseLayout from "../../layouts/BaseLayout.astro";
import Hero from "../../components/Hero.astro";
import Icon from "../../components/Icon.astro";
import ThemeToggle from "../../components/ThemeToggle.astro";

interface Props {
  entry: CollectionEntry<"projects">;
}

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<BaseLayout
  title={`Mathias B. Herholdt | ${entry.data.title}`}
  description={entry.data.description}
>
  <header
    class="container mx-auto px-4 gap-2 pb-10 border-b border-gray-400 dark:border-graydark-400"
  >
    <div class="flex justify-between">
      <a class="back-link p-2 text-gray-100 dark:text-graydark-100" href="/"
        ><Icon icon="arrow-left" />Back</a
      >
      <div class="theme-toggle">
        <ThemeToggle />
      </div>
    </div>
    <Hero title={entry.data.title}>
      <div class="p-2">
        <p
          class="description text-gray-0 dark:text-graydark-0 text-lg md:text-md"
        >
          {entry.data.description}
        </p>
      </div>
    </Hero>
  </header>
  <div class="container mx-auto px-4">
    <div class="content flex flex-wrap gap-20 text-gray-0 dark:text-graydark-0">
      <div class="max-w-prose">
        <Content />
        <div class="flex gap-4 mt-8">
          <button class="border w-24 h-10 rounded-sm"> Repo </button>
          <button class="border w-24 h-10 rounded-sm"> Live </button>
        </div>
      </div>

      <div class="flex gap-6">
        <div>
          {
            entry.data.img_main && (
              <img
                src={entry.data.img_main}
                alt={entry.data.img_main_alt || ""}
              />
            )
          }
        </div>
        <div>
          {
            entry.data.img_secondary && (
              <img
                src={entry.data.img_secondary}
                alt={entry.data.img_secondary_alt || ""}
              />
            )
          }
        </div>
      </div>
    </div>
  </div>

  <div class="flex gap-6"></div>
</BaseLayout>

<style>
  .description {
    max-width: 54ch;
  }

  .content img {
    box-shadow: var(--shadow-md);
    width: 380px;
    height: 400px;
    object-fit: cover;
    object-position: top;
    border-radius: 0.5rem;
  }

  .back-link,
  .content :global(a) {
    /* color: var(--gray-100); */
    text-decoration: 1px solid underline transparent;
    text-underline-offset: 0.25em;
    transition: text-decoration-color 0.2s ease-in-out;
  }

  .back-link:hover,
  .back-link:focus,
  .content :global(a:hover),
  .content :global(a:focus) {
    text-decoration-color: currentColor;
  }

  @media (min-width: 768px) {
    .back-link {
      display: block;
      align-self: flex-start;
    }
  }
</style>
